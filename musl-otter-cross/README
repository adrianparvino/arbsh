# Otter Musl Cross (OMC)
# Musl based cross compiler, 2 stages, relocatable toolchain, in tree binutils.

Using gcc-5.3, binutils-2.6 and musl-1.14 (current releases as of
15/04/2016). At this time however musl-otter-cross is syncing with mcm
and is using gcc-5.2.0 with binutils-2.25.1.

Musl-otter-cross uses a "two stage" system to create a cross compiler.
Gcc, musl and binutils are built using "read only source", (they are
configured and built in an outside directory).


The gcc build system is directory based / driven. Musl-otter-cross takes
advantage of this in (2) ways;
	1) The binutils build tree is linked into the gcc build tree.
	   This is referred to as a "combined tree".

	2) During the "second stage gcc build" a number of "--disable-*"
	   options are passed to gcc which suppress rebuilding of any 
	   binutils components.

In-tree build systems;
	Gcc contains a script called "symlink-tree" which is designed
	to fascilitate in-tree builds. Musl-otter-cross does not yet
	make use of this script. Running this script is not always
	needed, but as it was included by the gcc developers for this
	purpose, it would be best to use it.

Relocatable toolchains;
	Toolchains made with musl-otter-cross are configured with a
	sysroot so they are relocatable.


Musl-otter-cross utilizes the patch set from musl-cross-make. If you are 
creating a toolchain for a distribution make sure to check that out first
/too!;
	https://github.com/richfelker/musl-cross-make


The patches which musl-otter-cross strictly relies on are for configuring
gcc to accept musl based tuples. Musl should no longer need such patches 
after gcc version 6 (we are on 5.3 now).


Builds take between 10 and 20 minutes on most machines. I believe with
proper configuration and build target staging this could be halved.


When musl-otter-cross builds a "universe" or batch of architectures,
source code is shared between arches so as to minimize workload and 
disk footprint when testing multiple targets (read only source). 


Simple tests are performed after each target is finished building. If the 
tests succeeded the test which was passed is recorded in the report.
There are (4) tests:
	1> pthreads
		Compiles thread support.
	2> C
		Has access to a basic POSIX C api.
	3> C++
		C++ support.
	4> fortran 
		Fortran support.


Tests are recorded in a report which is named "machtype-report", where 
'machtype' is the host tuplet. The passing languages are also recorded in 
the report.


Musl-otter-cross has builtin support for staged logs and tests (an auto-
builder). All stages of a musl-otter-cross build are automatically logged
in such staged logs. These logs are given a UUID build number and recorded
along with a copy of the makefile which generated them here:

	https://github.com/cmgraff/0

The autobuilder attempts to push and pull from this site. If you do not
wish to contribute logs to musl-otter-cross, disable this section in the
"universe" target of the build's makefile.


BUILDING:
---------

	Download grafos and chdir to musl-otter-cross:

		git clone https://github.com/cmgraff/grafos/
                cd grafos/musl-otter-cross

	Build for the default architecture (i686-pc-linux-musl): 

		make

	Build for all architectures: 
       
                make universe

	Build for a specific architecture:
                
                make TARG=aarch-pc-linux-musl



