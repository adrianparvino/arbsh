/* 
	Copyright 2015, C. Graff  "dd" 
*/ 

struct tables {
	char ascii[256];
	char ebcdic[256];
	char ibm[256];
} tables = {{ 
        '\000', '\001', '\002', '\003', '\234', '\011', '\206', '\177',
        '\227', '\215', '\216', '\013', '\014', '\015', '\016', '\017',
        '\020', '\021', '\022', '\023', '\235', '\205', '\010', '\207',
        '\030', '\031', '\222', '\217', '\034', '\035', '\036', '\037',
        '\200', '\201', '\202', '\203', '\204', '\012', '\027', '\033',
        '\210', '\211', '\212', '\213', '\214', '\005', '\006', '\007',
        '\220', '\221', '\026', '\223', '\224', '\225', '\226', '\004',
        '\230', '\231', '\232', '\233', '\024', '\025', '\236', '\032',
        '\040', '\240', '\241', '\242', '\243', '\244', '\245', '\246',
        '\247', '\250', '\133', '\056', '\074', '\050', '\053', '\041',
        '\046', '\251', '\252', '\253', '\254', '\255', '\256', '\257',
        '\260', '\261', '\135', '\044', '\052', '\051', '\073', '\136',
        '\055', '\057', '\262', '\263', '\264', '\265', '\266', '\267',
        '\270', '\271', '\174', '\054', '\045', '\137', '\076', '\077',
        '\272', '\273', '\274', '\275', '\276', '\277', '\300', '\301',
        '\302', '\140', '\072', '\043', '\100', '\047', '\075', '\042',
        '\303', '\141', '\142', '\143', '\144', '\145', '\146', '\147',
        '\150', '\151', '\304', '\305', '\306', '\307', '\310', '\311',
        '\312', '\152', '\153', '\154', '\155', '\156', '\157', '\160',
        '\161', '\162', '\313', '\314', '\315', '\316', '\317', '\320',
        '\321', '\176', '\163', '\164', '\165', '\166', '\167', '\170',
        '\171', '\172', '\322', '\323', '\324', '\325', '\326', '\327',
        '\330', '\331', '\332', '\333', '\334', '\335', '\336', '\337',
        '\340', '\341', '\342', '\343', '\344', '\345', '\346', '\347',
        '\173', '\101', '\102', '\103', '\104', '\105', '\106', '\107',
        '\110', '\111', '\350', '\351', '\352', '\353', '\354', '\355',
        '\175', '\112', '\113', '\114', '\115', '\116', '\117', '\120',
        '\121', '\122', '\356', '\357', '\360', '\361', '\362', '\363',
        '\134', '\237', '\123', '\124', '\125', '\126', '\127', '\130',
        '\131', '\132', '\364', '\365', '\366', '\367', '\370', '\371',
        '\060', '\061', '\062', '\063', '\064', '\065', '\066', '\067',
        '\070', '\071', '\372', '\373', '\374', '\375', '\376', '\377' 
},{ 
        '\000', '\001', '\002', '\003', '\067', '\055', '\056', '\057',
        '\026', '\005', '\045', '\013', '\014', '\015', '\016', '\017',
        '\020', '\021', '\022', '\023', '\074', '\075', '\062', '\046',
        '\030', '\031', '\077', '\047', '\034', '\035', '\036', '\037',
        '\100', '\117', '\177', '\173', '\133', '\154', '\120', '\175',
        '\115', '\135', '\134', '\116', '\153', '\140', '\113', '\141',
        '\360', '\361', '\362', '\363', '\364', '\365', '\366', '\367',
        '\370', '\371', '\172', '\136', '\114', '\176', '\156', '\157',
        '\174', '\301', '\302', '\303', '\304', '\305', '\306', '\307',
        '\310', '\311', '\321', '\322', '\323', '\324', '\325', '\326',
        '\327', '\330', '\331', '\342', '\343', '\344', '\345', '\346',
        '\347', '\350', '\351', '\112', '\340', '\132', '\137', '\155',
        '\171', '\201', '\202', '\203', '\204', '\205', '\206', '\207',
        '\210', '\211', '\221', '\222', '\223', '\224', '\225', '\226',
        '\227', '\230', '\231', '\242', '\243', '\244', '\245', '\246',
        '\247', '\250', '\251', '\300', '\152', '\320', '\241', '\007',
        '\040', '\041', '\042', '\043', '\044', '\025', '\006', '\027',
        '\050', '\051', '\052', '\053', '\054', '\011', '\012', '\033',
        '\060', '\061', '\032', '\063', '\064', '\065', '\066', '\010',
        '\070', '\071', '\072', '\073', '\004', '\024', '\076', '\341',
        '\101', '\102', '\103', '\104', '\105', '\106', '\107', '\110',
        '\111', '\121', '\122', '\123', '\124', '\125', '\126', '\127',
        '\130', '\131', '\142', '\143', '\144', '\145', '\146', '\147',
        '\150', '\151', '\160', '\161', '\162', '\163', '\164', '\165',
        '\166', '\167', '\170', '\200', '\212', '\213', '\214', '\215',
        '\216', '\217', '\220', '\232', '\233', '\234', '\235', '\236',
        '\237', '\240', '\252', '\253', '\254', '\255', '\256', '\257',
        '\260', '\261', '\262', '\263', '\264', '\265', '\266', '\267',
        '\270', '\271', '\272', '\273', '\274', '\275', '\276', '\277',
        '\312', '\313', '\314', '\315', '\316', '\317', '\332', '\333',
        '\334', '\335', '\336', '\337', '\352', '\353', '\354', '\355',
        '\356', '\357', '\372', '\373', '\374', '\375', '\376', '\377' 
},{ 
        '\000', '\001', '\002', '\003', '\067', '\055', '\056', '\057',
        '\026', '\005', '\045', '\013', '\014', '\015', '\016', '\017',
        '\020', '\021', '\022', '\023', '\074', '\075', '\062', '\046',
        '\030', '\031', '\077', '\047', '\034', '\035', '\036', '\037',
        '\100', '\132', '\177', '\173', '\133', '\154', '\120', '\175',
        '\115', '\135', '\134', '\116', '\153', '\140', '\113', '\141',
        '\360', '\361', '\362', '\363', '\364', '\365', '\366', '\367',
        '\370', '\371', '\172', '\136', '\114', '\176', '\156', '\157',
        '\174', '\301', '\302', '\303', '\304', '\305', '\306', '\307',
        '\310', '\311', '\321', '\322', '\323', '\324', '\325', '\326',
        '\327', '\330', '\331', '\342', '\343', '\344', '\345', '\346',
        '\347', '\350', '\351', '\255', '\340', '\275', '\137', '\155',
        '\171', '\201', '\202', '\203', '\204', '\205', '\206', '\207',
        '\210', '\211', '\221', '\222', '\223', '\224', '\225', '\226',
        '\227', '\230', '\231', '\242', '\243', '\244', '\245', '\246',
        '\247', '\250', '\251', '\300', '\117', '\320', '\241', '\007',
        '\040', '\041', '\042', '\043', '\044', '\025', '\006', '\027',
        '\050', '\051', '\052', '\053', '\054', '\011', '\012', '\033',
        '\060', '\061', '\032', '\063', '\064', '\065', '\066', '\010',
        '\070', '\071', '\072', '\073', '\004', '\024', '\076', '\341',
        '\101', '\102', '\103', '\104', '\105', '\106', '\107', '\110',
        '\111', '\121', '\122', '\123', '\124', '\125', '\126', '\127',
        '\130', '\131', '\142', '\143', '\144', '\145', '\146', '\147',
        '\150', '\151', '\160', '\161', '\162', '\163', '\164', '\165',
        '\166', '\167', '\170', '\200', '\212', '\213', '\214', '\215',
        '\216', '\217', '\220', '\232', '\233', '\234', '\235', '\236',
        '\237', '\240', '\252', '\253', '\254', '\255', '\256', '\257',
        '\260', '\261', '\262', '\263', '\264', '\265', '\266', '\267',
        '\270', '\271', '\272', '\273', '\274', '\275', '\276', '\277',
        '\312', '\313', '\314', '\315', '\316', '\317', '\332', '\333',
        '\334', '\335', '\336', '\337', '\352', '\353', '\354', '\355',
        '\356', '\357', '\372', '\373', '\374', '\375', '\376', '\377' 
	
}}; 


size_t convert(size_t c)
{
	int ascii = glb.convs[0];
	int ebcdic = glb.convs[1];
	int ibm = glb.convs[2];
	int lcase = glb.convs[5];
	int ucase = glb.convs[6];

	if ( ucase == 1 )
		c = toupper(c);
	if ( lcase == 1 )
		c = tolower(c); 
	if ( ascii ) 
		c = tables.ascii[c];
	if ( ebcdic ) 
		c = tables.ebcdic[c];
	if ( ibm ) 
		c = tables.ibm[c];
	return c; 
}

void printoptions()
{
	if (glb.opt[0])
                printf("ifa is %s\n", glb.opt[0]);
        if (glb.opt[1])
                printf("ofa is %s\n", glb.opt[1]);
        if (glb.opt[2])
                printf("ibs after computation is :   %zu\n", glb.numbs[0]);
        if (glb.opt[3])
                printf("obs after computation is :   %zu\n", glb.numbs[1]);
        if (glb.opt[4])
                printf("bs after computation is :   %zu\n", glb.numbs[2]);
        if (glb.opt[5])
                printf("cbs after computation is :   %zu\n", glb.numbs[3]);
        if (glb.opt[6])
                printf("skip is %s\n", glb.opt[6]);
        if (glb.opt[7])
                printf("seek is %s\n", glb.opt[7]);
        if (glb.opt[8])
                printf("count is %s\n", glb.opt[8]);
        if (glb.opt[9])
                printf("conv is (string might be broken but that is ok) %s\n", glb.opt[9]);

        if ( glb.convs[0] )
                printf(" ascii activated\n");
        if ( glb.convs[1] )
                printf(" ebcdic activated\n");
        if ( glb.convs[2] )
                printf(" ibm activated\n");
        if ( glb.convs[3] )
                printf(" block activated\n");
        if ( glb.convs[4] )
                printf(" unblock activated\n");
        if ( glb.convs[5] )
                printf(" lcase activated\n");
        if ( glb.convs[6] )
                printf(" ucase activated\n");
        if ( glb.convs[7] )
                printf(" swab activated\n");
        if ( glb.convs[8] )
                printf(" noerror activated\n");
        if ( glb.convs[9] )
                printf(" notrunc activated\n");
        if ( glb.convs[10] )
                printf(" sync activated\n");
}
